---
title: "Time Series Analysis-GDP"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)
```


## Basic Time Series Analysis

This part is for basic time series analysis on Quarterly GDP data **(source:IMF)**. The dataset used here includes

```{r gdp_data1, echo=FALSE, message=FALSE, warning=FALSE, }
library(scales)
library(ggplot2)
library(TSstudio)
library(plotly)
library(forecast)
library(kableExtra)
library(DT)

gdp_data  <- read.csv("C:/Users/91981/Desktop/Uday/Personal_analysis_projects/Git_projects/Showcase_projects/showcase_project_website/data/GDP_IMF_India_quarterly_Q22004_Q32022.csv")

Nominal_gdp_unadjusted_rs <- gdp_data[,c(1,2,3)]

Nominal_gdp_unadjusted_rs%>%
  knitr::kable(caption = "Table 1. Quarterly Gross Domestic Product, Nominal, Undjusted, Domestic Currency 
               (2nd Quarter 2004 to 3rd Quarter 2022)")%>%
  kable_styling(bootstrap_options = "striped",
                latex_options = "striped")

```

There are total 74 rows using `nrow()` formula which means 74 quarters equivalent to around 18 years data. Now to apply times series it is important to convert the data in **TS (Time Series)** format 

```{r ts_gdp_data1_plot, echo=FALSE, message=FALSE, warning=FALSE}

options(scipen = 100, digits = 4)

ts_gdp_data1 <- with(Nominal_gdp_unadjusted_rs, ts(NGDP_NSA_XDC, start = c(Year[1], Quarter[1]), freq = 4))

ts_plot(ts_gdp_data1,
        title = "India Quarterly Gross Domestic Product (Nominal - Undjusted)
        at Domestic Currency",
        Xtitle = "Period",
        Ytitle = "Rs in Million",
        slider = TRUE,
        color = "blue",
        width = 3,
        line.mode = "lines+markers"
        )


```

Now if we apply linear regression model on the Nominal Unadjusted quarterly GDP then,

```{r ts_lm_model1}

gdp.linear.model1 = lm(ts_gdp_data1 ~ time(ts_gdp_data1))

summary(gdp.linear.model1)

```
Here, the overall model is statistically significant as the p-value is very small. Both the intercept and slope coefficients are statistically significant but the intercept coefficient does not provide any economic reasoning due to negative value.

```{r basic_lm_graph}
options(scipen = 100, digits = 4)
plot(ts_gdp_data1,
        main = "India Quarterly Gross Domestic Product (Nominal - Undjusted)
        at Domestic Currency and Linear Regression Trend",
        xlab = "Period",
        ylab = "Rs in Million",
        col = "blue",
        cex = 2)
abline(gdp.linear.model1, col='red')

```

One of the important assumption for linear regression is **Residuals Distributed Normally**. It is also to know the residuals are random or not, which is essential for explaining relation in the data.

```{r residual}
options(scipen = 100, digits = 4)
gdp.residuals = resid(gdp.linear.model1)

hist(gdp.residuals, main = "Histogram of Residuals")

```

```{r qqplot}
options(scipen = 100, digits = 4)
qqnorm(gdp.residuals, main = "Normal Q-Q plot", col="darkgrey")
qqline(gdp.residuals,  col="dodgerblue")

```


```{r fitted_vs_residuals}
options(scipen = 100, digits = 4)
plot(fitted(gdp.linear.model1), resid(gdp.linear.model1), col = "grey", xlab = "Fitted", ylab = "Residuals", main = "Fitted vs Residuals")
abline(h=0, col="darkorange")
```

```{r normality_test}

shapiro.test(gdp.residuals)

```

As we can see that the residuals are Non-normally distributed or Skewed distributed both visually and using the test. So, this model can't be used for inferential or predictive purpose.

## Time Series Modeling



